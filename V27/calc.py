import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
import uncertainties.unumpy as unp
from uncertainties import ufloat
from uncertainties.unumpy import nominal_values as noms
from uncertainties.unumpy import std_devs as sdevs

s1_rot, s2_rot = np.genfromtxt('data/rot.txt', unpack=True)
s1_blau1, s2_blau1 = np.genfromtxt('data/blau_pi.txt', unpack=True)
s1_blau2, s2_blau2 = np.genfromtxt('data/blau_sigma.txt', unpack=True)

a1 = ufloat(57.97058824, 0.39360412)
a2 = ufloat(18.27777778, 3.91960695)
b = 0.01070974507 * 10**9 # ch/2Âµ_B * 10^9
b1 = b * 48.91 / ((643.8**2) * (10 * a1 + a2)) # rot
b2 = b * 26.95 / ((480**2) * (17 * a1 + a2)) # blau, pi
b3 = b * 26.95 / ((480**2) * (6 * a1 + a2)) # blau, sigma

print("######## rot #########")
print(b1*s2_rot/s1_rot)
print("Magnetfeld: ", 10 * a1 + a2)
print("Mittelwert: ", np.mean(noms(b1*s2_rot/s1_rot)), " +/- ", np.mean(sdevs(b1*s2_rot/s1_rot)), '\n')
print("######## blau pi #########")
print(b2*s2_blau1/s1_blau1)
print("Magnetfeld: ", 17 * a1 + a2)
print("Mittelwert: ", np.mean(noms(b2*s2_blau1/s1_blau1)), " +/- ", np.mean(sdevs(b2*s2_blau1/s1_blau1)), '\n')
print("######## blau sigma #########")
print(b3*s2_blau2/s1_blau2)
print("Magnetfeld: ", 6 * a1 + a2)
print("Mittelwert: ", np.mean(noms(b3*s2_blau2/s1_blau2)), " +/- ", np.mean(sdevs(b3*s2_blau2/s1_blau2)), '\n')

# ######## rot #########
# [1.1077494703292445+/-0.010460718937477997
#  1.0447781034406682+/-0.009866066637680986
#  1.0222012892513757+/-0.009652868875855236
#  0.9510432091884771+/-0.00898090766476362
#  0.9344469196845236+/-0.008824185296975645
#  0.9576257591335571+/-0.009043068114135737
#  0.9361211806828387+/-0.008839995707362163
#  0.9091733823688586+/-0.00858552179273
#  0.9636149022711855+/-0.00909962489409108]
# Magnetfeld:  597+/-6
# Mittelwert:  0.9807504684834143  +/-  0.009261439769008051
#
# ######## blau pi #########
# [0.5193681825099135+/-0.00407775216523497
#  0.5672290590351825+/-0.0044535256520469675
#  0.5045890847958232+/-0.003961715989486566
#  0.5208353242684161+/-0.004089271239148064
#  0.4945073847999027+/-0.0038825608248614597
#  0.5640265462809189+/-0.004428381537028636
#  0.5519501618221135+/-0.0043335653651231446
#  0.5236506503455427+/-0.004111375408008325
#  0.5034741467928021+/-0.003952962197843129
#  0.48507648110968893+/-0.0038085153033259583
#  0.5122970402640158+/-0.004022234005719407
#  0.5580378474304457+/-0.004381362041944354]
# Magnetfeld:  1002+/-8
# Mittelwert:  0.5254201591212305  +/-  0.004125268477480915
#
# ######## blau sigma #########
# [1.38653182615026+/-0.017626392371676663
#  1.2447006843411712+/-0.015823353084081556
#  1.4510869516592801+/-0.018447054364689953
#  1.4349338501565794+/-0.018241706820741634
#  1.4481554628680493+/-0.018409787588195625
#  1.4820304444556058+/-0.01884042589435225
#  1.4950592835277432+/-0.019006056012104793
#  1.3155557917907297+/-0.016724104081561997
#  1.4699322367457641+/-0.01868662649929631
#  1.3191699560538908+/-0.016770049422445407
#  1.2991825324773167+/-0.01651595776452957
#  1.3719367542960468+/-0.017440851399343225]
# Magnetfeld:  365+/-5
# Mittelwert:  1.3931896478768697  +/-  0.01771103044191825
